<?xml version="1.0" encoding="utf-8"?>
<ContentPage
    x:Class="Album_music_toma.Views.ArtistDetailPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:viewmodels="clr-namespace:Album_music_toma.ViewModels"
    xmlns:models="clr-namespace:Album_music_toma.Models"
    Title="{Binding Artist.Name}">

    <ContentPage.BindingContext>
        <viewmodels:ArtistDetailViewModel />
    </ContentPage.BindingContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>
        
        <!-- Header avec gradient et photo -->
        <Grid Grid.Row="0" BackgroundColor="#667eea">
            
            <VerticalStackLayout Padding="20,60,20,30" Spacing="15">
                <!-- Photo et infos de l'artiste -->
                <Grid ColumnDefinitions="120,*" ColumnSpacing="20">
                    <Frame Padding="0" 
                           CornerRadius="60" 
                           HasShadow="True" 
                           HeightRequest="120" 
                           WidthRequest="120"
                           BackgroundColor="White">
                        <Frame.Shadow>
                            <Shadow Brush="Black" Offset="0,5" Radius="15" />
                        </Frame.Shadow>
                        <Image Aspect="AspectFill" Source="{Binding Artist.PhotoUrl}" />
                    </Frame>
                    
                    <VerticalStackLayout Grid.Column="1" 
                                        Spacing="8" 
                                        VerticalOptions="Center">
                        <Label Text="{Binding Artist.Name}" 
                               FontSize="28" 
                               FontAttributes="Bold" 
                               TextColor="White" />
                        <Label Text="{Binding Artist.Genre}" 
                               FontSize="16" 
                               TextColor="LightGray" />
                    </VerticalStackLayout>
                </Grid>
            </VerticalStackLayout>
        </Grid>

        <!-- Contenu scrollable -->
        <ScrollView Grid.Row="1" BackgroundColor="#f8f9fa">
            <VerticalStackLayout Padding="20" Spacing="20">
                
                <!-- Section Biographie -->
                <Frame Padding="20" 
                       CornerRadius="20" 
                       HasShadow="True" 
                       BackgroundColor="White"
                       Margin="0,0,0,10">
                    <Frame.Shadow>
                        <Shadow Brush="Black" Offset="0,3" Radius="10" />
                    </Frame.Shadow>
                    <VerticalStackLayout Spacing="12">
                        <Label Text="ðŸ“– Biographie" 
                               FontSize="22" 
                               FontAttributes="Bold" 
                               TextColor="#667eea" />
                        <Label Text="{Binding Artist.Bio, FallbackValue='Biographie en cours de chargement...'}" 
                               FontSize="16" 
                               LineBreakMode="WordWrap" 
                               TextColor="#333"
                               BackgroundColor="#f8f9fa"
                               Padding="15" />
                    </VerticalStackLayout>
                </Frame>

                <!-- Section Albums -->
                <Label Text="ðŸ’¿ Albums" 
                       FontSize="24" 
                       FontAttributes="Bold" 
                       TextColor="#333"
                       Margin="0,10,0,15" />
                
                <CollectionView ItemsSource="{Binding Albums}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="models:Album">
                            <Frame Padding="0" 
                                   CornerRadius="15" 
                                   HasShadow="True" 
                                   BackgroundColor="White"
                                   Margin="0,0,0,15">
                                <Frame.Shadow>
                                    <Shadow Brush="Black" Offset="0,2" Radius="8" />
                                </Frame.Shadow>
                                
                                <VerticalStackLayout Spacing="0">
                                    <!-- Header de l'album -->
                                    <VerticalStackLayout Spacing="5" 
                                                        Padding="15">
                                        <Label Text="{Binding Title}" 
                                               FontSize="20" 
                                               FontAttributes="Bold" 
                                               TextColor="#333" />
                                        <Label Text="{Binding Year}" 
                                               FontSize="16" 
                                               TextColor="#666" />
                                    </VerticalStackLayout>
                                    
                                    <!-- SÃ©parateur -->
                                    <BoxView HeightRequest="1" 
                                             BackgroundColor="#e9ecef" 
                                             Margin="15,0" />
                                    
                                    <!-- Chansons -->
                                    <VerticalStackLayout Padding="15" Spacing="8">
                                        <Label Text="ðŸŽµ Titres" 
                                               FontSize="16" 
                                               FontAttributes="Bold" 
                                               TextColor="#667eea" />
                                        
                                        <!-- AperÃ§u des chansons (sans liens directs) -->
                                        <VerticalStackLayout BindableLayout.ItemsSource="{Binding Songs}">
                                            <BindableLayout.ItemTemplate>
                                                <DataTemplate x:DataType="models:Song">
                                                    <Frame Padding="12,8"
                                                           BackgroundColor="#f8f9fa"
                                                           CornerRadius="8"
                                                           Margin="0,2"
                                                           HasShadow="False">
                                                        <Label Text="{Binding Title}"
                                                               FontSize="14"
                                                               FontAttributes="Bold"
                                                               TextColor="#2c3e50"
                                                               VerticalOptions="Center" />
                                                    </Frame>
                                                </DataTemplate>
                                            </BindableLayout.ItemTemplate>
                                        </VerticalStackLayout>
                                        
                                        <!-- Bouton pour voir les chansons de cet album -->
                                        <Button Text="ðŸŽµ Ã‰couter cet album"
                                                BackgroundColor="#3498db"
                                                TextColor="White"
                                                FontSize="14"
                                                FontAttributes="Bold"
                                                CornerRadius="10"
                                                Padding="15,8"
                                                Margin="0,10,0,0"
                                                Command="{Binding BindingContext.ViewSongsCommand, Source={RelativeSource AncestorType={x:Type ContentPage}}}"
                                                CommandParameter="{Binding}" />
                                    </VerticalStackLayout>
                                </VerticalStackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
                
            </VerticalStackLayout>
        </ScrollView>
    </Grid>
</ContentPage>